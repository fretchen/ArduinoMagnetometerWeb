{% extends "base.html" %}
{% import 'bootstrap/wtf.html' as wtf %}

{% block app_content %}
You have currently {{ n_ards }} arduinos connected.
{% if n_ards %}
<div class="container">
  <div class="row">
    {% if conn_open %}
    <div class="col bg-success">The connection is established. </div>
    <div class="col"> {{ wtf.quick_form(dform, id="stop", action="/stop") }} </div>
    {% else %}
    <div class="col bg-warning">The connection is closed.</div>
    <div class="col-sm"> {{ wtf.quick_form(cform, id="connect", action="/start") }} </div>
    {% endif %}
  </div>
{% endif %}
{% if not n_ards %}
<h1>Connect an Arduino</h1>
<div class="row">
  <div class="col">We should connect him on a serial port like: {{ port }}</div>
  <div class="col"> {{ wtf.quick_form(form, action="/update") }}</div>
</div>
{% endif %}

{% if n_ards %}
<h1>Update settings on the Arduino</h1>
<div class="row">
    <div class="col"> {{ wtf.quick_form(arduino_form, action="/arduino") }}</div>
  </div>
  <div class="row">
      <div class="col"> {{ wtf.quick_form(gform, action="/gain") }}</div>
  </div>
  <div class="row">
      <div class="col"> {{ wtf.quick_form(iform, action="/integral") }}</div>
  </div>
  <div class="row">
      <div class="col"> {{ wtf.quick_form(diff_form, action="/diff") }}</div>
  </div>
</div>
{% endif %}
{% endblock %}


{% block scripts %}
{{super()}}
<script type="text/javascript" src="//code.jquery.com/jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.5/socket.io.min.js"></script>
<script type="text/javascript" charset="utf-8">
$(document).ready(function() {
  namespace = '';
  // Connect to the Socket.IO server.
  // The connection URL has the following format:
  //     http[s]://<domain>:<port>[/<namespace>]
  var socket = io.connect(location.protocol + '//' + document.domain + ':' + location.port + namespace);
  // Event handler for new connections.
  socket.on('connect', function() {
    socket.emit('my_response', {data: 'I\'m connected!'});
  });
});
</script>
{% endblock %}
